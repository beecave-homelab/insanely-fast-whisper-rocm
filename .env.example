# Insanely Fast Whisper API - Environment Configuration
# Copy this file to `.env` and adjust any values you need.
# All variables are optional – sensible defaults are applied in code.

#------------------------------------------------------------------------------
# Model Configuration (affect CLI / API / WebUI defaults)
#------------------------------------------------------------------------------

# Hugging-Face model to use for transcription / translation
WHISPER_MODEL=distil-whisper/distil-large-v3

# Device ID: "0", "1", … for CUDA; "mps" for Apple Silicon; "cpu" for CPU
WHISPER_DEVICE=0

# Batch size (1-32). Larger = faster but more GPU memory.
WHISPER_BATCH_SIZE=4

# Progress granularity: number of chunks submitted per pipeline call for UI updates.
# Higher values reduce progress update frequency (potentially slightly faster),
# lower values increase responsiveness. Independent of model batch size.
PROGRESS_GROUP_SIZE=4

# Timestamp granularity: chunk | word
WHISPER_TIMESTAMP_TYPE=chunk

# Language code (e.g. en, fr) or None to auto-detect
WHISPER_LANGUAGE=None

# Inference dtype: float16 | float32 | bfloat16
WHISPER_DTYPE=float16

# Use BetterTransformer acceleration (true | false)
WHISPER_BETTER_TRANSFORMER=false

# Maximum audio length (seconds) processed per chunk
WHISPER_CHUNK_LENGTH=30

#------------------------------------------------------------------------------
# Timestamp Stabilization Defaults  (affect CLI / API / WebUI defaults)
#------------------------------------------------------------------------------

# Enable word-level stabilization by default
STABILIZE_DEFAULT=false

# Run Demucs source-separation before stabilization
DEMUCS_DEFAULT=false

# Run Voice Activity Detection (VAD) before stabilization
VAD_DEFAULT=false

# Default VAD threshold (0-1); lower = more aggressive speech detection
VAD_THRESHOLD_DEFAULT=0.35

#------------------------------------------------------------------------------
# Diarization Configuration (needed for some diarization models)
#------------------------------------------------------------------------------

WHISPER_DIARIZATION_MODEL=pyannote/speaker-diarization
# HF_TOKEN=your_huggingface_token_here

#------------------------------------------------------------------------------
# File Handling
#------------------------------------------------------------------------------

WHISPER_UPLOAD_DIR=temp_uploads
WHISPER_TRANSCRIPTS_DIR=transcripts

# Application timezone (affects filenames / logs)
TZ=Europe/Amsterdam

#------------------------------------------------------------------------------
# Audio Chunking Configuration
#------------------------------------------------------------------------------

AUDIO_CHUNK_DURATION=600        # seconds
AUDIO_CHUNK_OVERLAP=1.0         # seconds
AUDIO_CHUNK_MIN_DURATION=5.0    # seconds

#------------------------------------------------------------------------------
# ROCm / HIP (AMD GPU) Configuration
#------------------------------------------------------------------------------

# PYTORCH_HIP_ALLOC_CONF=expandable_segments:True
HSA_OVERRIDE_GFX_VERSION=10.3.0
# HIP_LAUNCH_BLOCKING=1

#------------------------------------------------------------------------------
# Additional Configuration
#------------------------------------------------------------------------------

SAVE_TRANSCRIPTIONS=true

# API bind address and port (used when not overridden by CLI flags)
API_HOST=0.0.0.0
API_PORT=8888

# WebUI bind address and port (used when not overridden by CLI flags)
WEBUI_HOST=0.0.0.0
WEBUI_PORT=7860

# Logging level: DEBUG | INFO | WARNING | ERROR
LOG_LEVEL=INFO